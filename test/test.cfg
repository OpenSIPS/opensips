debug=9          # debug level (cmd line: -dddddddddd)
check_via=1      # (cmd. line: -v)
dns=on           # (cmd. line: -r)
rev_dns=yes      # (cmd. line: -R)
fork=no          # (cmd. line: -D)
log_stderror=yes # (cmd line: -E)
# for more info: sip_router -h

route{

	(src_ip=~'(dorian)|(ekina)|(terix)' & method=~'^inv') \
				forward(centauri.fokus.gmd.de);
	src_ip=~"^192\.168\.[0-9]{1,3}\.[0-9]{1,3}$"  \
				log(1,"msg. from a private network\n"); route(1);
	src_ip==0.0.0.0/0   setuserpass("andrei:test"); log(1, " test msg\n"); forward(192.168.46.55);setuser("foo");sethostport("bar.com:6000");forward(192.168.46.69);drop;
}

route[1]{
	src_ip==192.168.46.61  log("possible loop, dropping\n"); drop;
	(src_ip==192.168.46.0/24) log("routing with rt2\n");route(2); log("we're back\n");
	src_ip==0.0.0.0/0 log(1, "we'll drop this one too\n"); drop;
}

route[2]{
	(method=~'^ACK' and uri=~'.*fokus') forward("fox.iptel.org");
	! method=~'^INV' forward(193.175.135.179); /* dorian */
	method=~'.' log("spying...\n"); send(dorian,8000); \
						forward("fox.iptel.org");
}
