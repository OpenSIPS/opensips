CC=gcc
CFLAGS=-Wall -Wextra -std=c99 -g
LDFLAGS=-lcurl

# Target executable
TARGET=test_ens_validation

# Source files
SOURCES=test_ens_validation.c

# Object files
OBJECTS=$(SOURCES:.c=.o)

# Default target
all: $(TARGET)

# Build the test program
$(TARGET): $(OBJECTS)
	$(CC) $(OBJECTS) -o $(TARGET) $(LDFLAGS)

# Compile source files
%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

# Test with the provided example data
test: $(TARGET)
	./$(TARGET) jonathan 123123 jonathan123.eth

# Test with non-ENS name (should fallback)
test-normal: $(TARGET)
	./$(TARGET) normaluser 123123 normaluser

# Clean build artifacts
clean:
	rm -f $(OBJECTS) $(TARGET)

# Help target
help:
	@echo "Available targets:"
	@echo "  all         - Build the test program"
	@echo "  test        - Run test with example ENS data (jonathan123.eth)"
	@echo "  test-normal - Run test with normal username (no ENS)"
	@echo "  clean       - Remove build artifacts"
	@echo "  help        - Show this help message"
	@echo ""
	@echo "Usage:"
	@echo "  make"
	@echo "  make test"
	@echo "  ./test_ens_validation jonathan 123123 jonathan123.eth"

.PHONY: all test test-normal clean help 