#
# README,v 1.0 2003/1/20 jih
#


Module depends on:  sl    - Used for stateless replies


Exported parameters:
-------------------

Name:    radius_config
Type:    string
Default: "/usr/local/etc/radiusclient/radiusclient.conf"
Desc:    Radiusclient configuration file

Name:    service_type
Type:    int
Default: 15 (SIP)
Desc:    Radius service type used for authentication

Name:    secret
Type:    string
Default: "4e9rhygt90ofw34e8hiof09tg"
Desc:    Nonce secret phrase

Name:    nonce_expire
Type:    integer
Default: 300
Desc:    Every nonce is valid only for a limited amount of time. This
         parameter specifies nonce validity interval in seconds. 
         
Name:    retry_count
Type:    integer
Default: 5
Desc:    This parameter specifies how many times a user is allowed to
         retry authentication with incorrect credentials. After that 
         the user will receive 403 Forbidden and must retry with different 
         credentials. This should prevent DoS attacks from misconfigured
         user agents which try to authenticate with incorrect password 
         again and again and again......


Exported Functions:
------------------

Name:   radius_www_authorize
Params: realm - realm string
Desc:   Checks digest credentials in Authorization header from Radius
        according to draft-sterman-aaa-sip-00.txt.  If realm parameter
	is not an empty string, realm in Authorization header must match
	realm parameter.  Realm in Authorization header must match host
	of To URI.  Also user of To URI is passed to Radius for
	possible checking in SER specific SIP-URI-User attribute.
	Service type of the request is Authenticate-Only.

Name:   radius_proxy_authorize
Params: realm - realm string
Desc:   Checks digest credentials in Authorization header from Radius
        according to draft-sterman-aaa-sip-00.txt.  If realm parameter
	is not an empty string, realm in Authorization header must match
	realm parameter.  Realm in Authorization header must match host
	of From URI.  Also user of From URI is passed to Radius for
	possible checking in SER specific SIP-URI-User attribute.
	Service type of the request is Authenticate-Only.

Name:   www_challenge
Params: realm - realm string
        qop   - qop string, "1" means use qop parameter
                            "0" means do not use qop parameter
Desc:   Challenges a user agent using WWW-Authenticate header
        field. The second parameter specifies if qop parameter
        (according to rfc2617) should be used or not.
        (Turning off is useful primarly to make UAC happy, which
	have a brokn qop implementation, particularly M$ Messenger 4.6).

Name:   proxy_challenge
Params: realm - realm string
        qop   - qop string, "1" means use qop parameter
                            "0" means do not use qop parameter
Desc:   Challenges a user agent using Proxy-Authenticate header
        field. The second parameter specifies if qop parameter
        (according to rfc2617) should be used or not.
	(Turning off is useful primarly to make UAC happy, which
	have a brokn qop implementation, particularly M$ Messenger 4.6).

Name:   consume_credentials
Params: -
Desc:   Removes previously authorized credentials from the message.
        The function must be called after {www,proxy}_authorize.

Name:   radius_does_user_exist
Params: -
Desc:   Checks from Radius if user in Request URI does exist.  This is
        needed in order to choose between 404 and 480 reply.  User is
	passed to Radius in User-Name attribute.  Service Type of the
	request is Call-Check.

Name:   radius_is_in_group
Params: group - group string
Desc:   Check from Radius if a user belongs to a group. User-Name is
        digest username or digest username@realm (if username does not
	have domain), SIP-Group is group, and Service-Type is
	Group-Check.  SIP-Group is SER specific attribute and
	Group-Check is SER specific service type value.  Call
	after *_authorize, otherwise the username is unverified. 


Radius Configuration:
--------------------

In order to use the module, the following no-standard entities needs to
be added to radiusclient and Radius server dictionaries.

#
# 	Digest authentication attributes (draft-sterman-aaa-sip-00.txt)
#
ATTRIBUTE       Digest-Response         206     string
ATTRIBUTE       Digest-Attributes       207     string

#
# 	IPTEL SIP attributes
#
ATTRIBUTE       SIP-URI-User		208     string
ATTRIBUTE       SIP-Method		209     integer
ATTRIBUTE       SIP-Request-URI		210     string
ATTRIBUTE       SIP-Group		211     string

#	IPTEL SIP Service Type

VALUE           Service-Type            Group-Check		12
