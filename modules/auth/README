#
# $Id$
#

Module depends on: sl - Used for stateless replies 

This module provides generic functions that are not authentication
mechanism specific. Rest of functions (those that require access
to the database or a radius server) are in separate modules.

Exported parameters:
-------------------

Name:    secret
Type:    string
Default: Randomly generated
Desc:    Nonce secret phrase to be used

Name:    nonce_expire
Type:    integer
Default: 300
Desc:    Every nonce is valid only for a limited amount of time. This
         parameter specifies nonce validity interval in seconds. 
         
Name:    rpid_suffix
Type:    string
Default: ";party=calling;id-type=subscriber;screen=yes"
Desc:    Suffix to be added to Remote-Party-ID header field after the
         string returned from Radius as the value of SIP-RPID reply
	 attribute.
		  

Exported Functions:
------------------

Name:   www_challenge
Params: realm - realm string
        qop   - qop string, "1" means use qop parameter
                            "0" means do not use qop parameter
Desc:   Challenges a user agent using WWW-Authenticate header
        field. The second parameter specifies if qop parameter
        (according to rfc2617) should be used or not.
        (Turning off is useful primarly to make UAC happy, which
	 have a brokn qop implementation, particularly M$ Messenger 4.6).

Name:   proxy_challenge
Params: realm - realm string
        qop   - qop string, "1" means use qop parameter
                            "0" means do not use qop parameter
Desc:   Challenges a user agent using Proxy-Authenticate header
        field. The second parameter specifies if qop parameter
        (according to rfc2617) should be used or not.
	(Turning off is useful primarly to make UAC happy, which
	 have a broken qop implementation, particularly M$ Messenger 4.6).

Name:   consume_credentials
Params: -
Desc:   Removes previously authorized credentials from the message.
        The function must be called after {www,proxy}_authorize.

Name:    is_rpid_user_e164
Params:  -
Desc:    Checks if the SIP URI in the saved SIP-RPID reply attribute
	 contains an E164 number (+ followed by up to 15 decimal digits)
	 in its user part.  Check faild, if no saved SIP-RPID exists.

Name:    append_rpid_hf
Params:  -
Desc:    Appends to the message a Remote-Party-ID header that contains
         header 'Remote-Party-ID: ' followed by the saved value of the
         SIP-RPID reply attribute followed by the value of module
         parameter radius_rpid_suffix.  If no saved SIP-RPID exists, no
         header is appended.

									
